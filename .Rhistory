ggplot(establishment_55)+
geom_smooth(aes(elapsed, dist_release, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Distance from release site to roost by day (m)")
# plot cohort mean for daily distance between roosts over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, dist_release, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Distance from release site to roost (m)")
# distribution of movement data
hist(establishment_55$distance_previous)
# distribution of movement data
hist(establishment_55$dist_release)
ggqqplot(establishment_55$dist_release)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(distance_previous))
hist(establishment_55$dist_log)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(dist_release))
hist(establishment_55$dist_log)
ggqqplot(establishment_55$dist_log)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_sqrt = sqrt(dist_release))
hist(establishment_55$dist_sqrt)
ggqqplot(establishment_55$dist_sqrt)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_boxcox = boxcox(dist_release))
# Packages
pacman::p_load(amt, atlastools, beepr, EnvStats, ggfortify, ggmap, ggnewscale, ggpubr, ggridges, janitor, lme4, lmerTest, move, scattermore, sf, spThin, suncalc, survival, survminer, terra, tidyterra, tidyverse)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_boxcox = boxcox(dist_release))
boxcox(dist_release)
# test whether establishment differs between the groups
m3 <- lmer(dist_release ~ cohort * elapsed + (1|id), data = establishment_55)
# test whether establishment differs between the groups
m3 <- lmer(dist_release ~ cohort * elapsed + (1|id), data = establishment_55) %>%
boxcox()
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(dist_release))
hist(establishment_55$dist_log)
ggqqplot(establishment_55$dist_log)
# correct right skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(log(dist_release)))
hist(establishment_55$dist_log)
# correct right skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(dist_release))
hist(establishment_55$dist_log)
# test whether establishment differs between the groups
m3 <- lmer(dist_log ~ cohort * elapsed + (1|id), data = establishment_55)
summary(m2)
summary(m3)
anova(m3)
# plot cohort mean for daily distance between roosts over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, dist_release, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Distance from release site to roost (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(dist_release))
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(dist_release, colour = cohort))
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_release))
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_release))+
theme_bw()
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_release))+
theme_bw()+
xlab("Cohort") +
ylab("Distance from release site to roost (m)")
# read in data
distance_roosts <- read.csv("data/distance_between_daily_roosts.csv")
# filter to first 100 days
establishment_100 <- distance_roosts %>%
# add metadata
left_join(select(metadata, c("id", "cohort", "start_date"))) %>%
# format dates as dates
mutate(date = as_date(date),
start_date = as_date(start_date)) %>%
# calculate time since release
mutate(elapsed = as.numeric(date - start_date)) %>%
# filter to establishment period
filter(elapsed < 100)
# read in data
distance_roosts <- read.csv("data/distance_between_daily_roosts.csv")
# read in data
distance_roosts <- read.csv("data/daily_distance_between_roosts.csv")
# filter to first 100 days
establishment_100 <- distance_roosts %>%
# add metadata
left_join(select(metadata, c("id", "cohort", "start_date"))) %>%
# format dates as dates
mutate(date = as_date(date),
start_date = as_date(start_date)) %>%
# calculate time since release
mutate(elapsed = as.numeric(date - start_date)) %>%
# filter to establishment period
filter(elapsed < 100)
# calculate cohort means
summary <- establishment_100 %>%
group_by(cohort, elapsed) %>%
summarise(mean_distance_previous = mean(distance_previous))
# limit cohort daily means to 55 days (minimum period for reinforcers)
establishment_55 <- establishment_100 %>%
filter(elapsed < 56)
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, distance_previous))+
theme_bw()+
xlab("Cohort") +
ylab("Distance between roosts per day (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, log(distance_previous)))+
theme_bw()+
xlab("Cohort") +
ylab("Distance between roosts per day (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Log distance between roosts per day (m)")
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(distance_previous))
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Log distance between roosts per day (m)")
# Metadata - translocation information
metadata  <- read.csv("data/metadata.csv") %>%
clean_names() %>%
rename(id = identity,
mortality = mortality_or_capture) %>%
mutate(start_date = as_date(dmy(start_date)),
end_date = as_date(dmy(end_date)),
mortality = as_date(dmy(mortality)))
# read in data
distance_daily <- read.csv("data/daily_distance_moved.csv")
# filter to establishment period
establishment_100 <- distance_daily %>%
# add metadata
left_join(select(metadata, c("id", "cohort", "start_date"))) %>%
# format dates as dates
mutate(date_bird = as_date(date_bird),
start_date = as_date(start_date)) %>%
# calculate time since release
mutate(elapsed = as.numeric(date_bird - start_date)) %>%
# filter to establishment period
filter(elapsed < 100)
# calculate cohort means
summary <- establishment_100 %>%
group_by(cohort, elapsed) %>%
summarise(mean_daily_dist = mean(daily_dist))
# plot distance moved by cohort during establishment
ggplot(summary)+
geom_path(aes(elapsed, mean_daily_dist, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Mean daily distance moved (m)")
# limit cohort daily means to 55 days (minimum period for reinforcers)
establishment_55 <- establishment_100 %>%
filter(elapsed < 56)
# distribution of movement data
hist(establishment_55$daily_dist)
ggqqplot(establishment_55$daily_dist)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_sqrt = sqrt(daily_dist))
hist(establishment_55$dist_sqrt)
ggqqplot(establishment_55$dist_sqrt)
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_sqrt))+
theme_bw()+
xlab("Cohort") +
ylab("Log distance travelled per night (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_sqrt))+
theme_bw()+
xlab("Cohort") +
ylab("Distance travelled per night (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist))+
theme_bw()+
xlab("Cohort") +
ylab("Distance travelled per night (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, daily_dist))+
theme_bw()+
xlab("Cohort") +
ylab("Distance travelled per night (m)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, daily_dist, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Daily distance moved (m)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, dist_sqrt, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Daily distance moved (m)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, daily_dist, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Daily distance moved (m)")
# read in data
distance_roosts <- read.csv("data/daily_distance_between_roosts.csv")
# filter to first 100 days
establishment_100 <- distance_roosts %>%
# add metadata
left_join(select(metadata, c("id", "cohort", "start_date"))) %>%
# format dates as dates
mutate(date = as_date(date),
start_date = as_date(start_date)) %>%
# calculate time since release
mutate(elapsed = as.numeric(date - start_date)) %>%
# filter to establishment period
filter(elapsed < 100)
# calculate cohort means
summary <- establishment_100 %>%
group_by(cohort, elapsed) %>%
summarise(mean_distance_previous = mean(distance_previous))
# plot distance moved between roosts by cohort during establishment
ggplot(summary)+
geom_path(aes(elapsed, mean_distance_previous, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Mean distance moved between roosts per day (m)")
# limit cohort daily means to 55 days (minimum period for reinforcers)
establishment_55 <- establishment_100 %>%
filter(elapsed < 56)
# distribution of movement data
hist(establishment_55$distance_previous)
ggqqplot(establishment_55$distance_previous)
# correct left skew
establishment_55 <- establishment_55 %>%
mutate(dist_log = log(distance_previous))
hist(establishment_55$dist_log)
ggqqplot(establishment_55$dist_log)
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Log distance between roosts per day (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, distance_previous))+
theme_bw()+
xlab("Cohort") +
ylab("Log distance between roosts per day (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Log distance between roosts per day (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Distance between roosts per day (log transformed")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Distance between roosts per day (log transformed)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, distance_previous, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Daily distance between roosts (m)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, dist_log, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Daily distance between roosts (m)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, distance_previous, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Daily distance between roosts (m)")
# plot difference between cohorts (without time)
ggplot(establishment_55)+
geom_boxplot(aes(cohort, dist_log))+
theme_bw()+
xlab("Cohort") +
ylab("Distance between consecutive roosts (log transformed)")
# plot difference over time
ggplot(establishment_55)+
geom_smooth(aes(elapsed, distance_previous, color = cohort), method = "lm")+
theme_minimal() +
xlab("Days post-release") +
ylab("Distance between consecutive roosts (m)")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(date, dist_release, group = id))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)")+
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
dist_release <- read.csv("data/daily_roost_distance_from_release.csv")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(date, dist_release, group = id))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)")+
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(date, dist_release, group = id))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, group = id))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, colour = id))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, colour = id))+
scale_colour_viridis_c()+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, colour = id))+
scale_colour_viridis_d()+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, group = id))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, group = id), colour = "grey40")+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, group = id), colour = "grey")+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
40
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, group = id), colour = "grey30")+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(dist_release)+
geom_path(aes(as_date(date), dist_release, group = id, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
View(distance_roosts)
# plot distance over time (real dates)
ggplot(distance_roosts)+
geom_path(aes(as_date(date), distance_previous, group = id, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
View(distance_roosts)
View(dist_release)
# read in data
distance_roosts <- read.csv("data/daily_distance_between_roosts.csv") %>%
# add metadata
left_join(select(metadata, c("id", "cohort", "start_date"))) %>%
# format dates as dates
mutate(date = as_date(date),
start_date = as_date(start_date))
# filter to first 100 days
establishment_100 <- distance_roosts %>%
# calculate time since release
mutate(elapsed = as.numeric(date - start_date)) %>%
# filter to establishment period
filter(elapsed < 100)
# plot distance over time (real dates)
ggplot(distance_roosts)+
geom_path(aes(as_date(date), distance_previous, group = id, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Roost distance from release site (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance over time (real dates)
ggplot(distance_roosts)+
geom_path(aes(as_date(date), distance_previous, group = id, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Distance between roosts (m)") +
# add bar for arrival of new birds
geom_vline(xintercept = as_date("2023-06-07"), linetype = "dashed")
# plot distance moved between roosts by cohort during establishment
ggplot(summary)+
geom_path(aes(elapsed, mean_distance_release, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Mean distance between roost and release location (m)")
dist_release <- read.csv("data/daily_roost_distance_from_release.csv")
# filter to first 100 days
establishment_100 <- dist_release %>%
# add metadata
left_join(select(metadata, c("id", "cohort", "start_date"))) %>%
# format dates as dates
mutate(date = as_date(date),
start_date = as_date(start_date)) %>%
# calculate time since release
mutate(elapsed = as.numeric(date - start_date)) %>%
# filter to establishment period
filter(elapsed < 100)
# calculate cohort means
summary <- establishment_100 %>%
group_by(cohort, elapsed) %>%
summarise(mean_distance_release = mean(dist_release))
# plot distance moved between roosts by cohort during establishment
ggplot(summary)+
geom_path(aes(elapsed, mean_distance_release, colour = cohort))+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Days post-release") +
ylab("Mean distance between roost and release location (m)")
