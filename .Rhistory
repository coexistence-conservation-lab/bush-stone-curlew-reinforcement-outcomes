# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2, 5), y = c(-3, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2, 5), y = c(-3, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2.5, 5), y = c(-4, 4))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2.5, 5), y = c(-4, 4))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2, 4), y = c(-3, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2, 4.5), y = c(-3, 3))
# set seed to keep layout static
set.seed(8888)
networkfr <- create_layout(network, layout = "fr")
# add community and cohort to network layout
comm <- networkfr %>%
rename(id = name) %>%
mutate(community = as.factor(membership(w))) %>%
left_join(select(metadata, c(id, cohort)))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2, 4.5), y = c(-3, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
# set seed to keep layout static
set.seed(9999)
networkfr <- create_layout(network, layout = "fr")
# add community and cohort to network layout
comm <- networkfr %>%
rename(id = name) %>%
mutate(community = as.factor(membership(w))) %>%
left_join(select(metadata, c(id, cohort)))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
# set seed to keep layout static
set.seed(0000)
networkfr <- create_layout(network, layout = "fr")
# add community and cohort to network layout
comm <- networkfr %>%
rename(id = name) %>%
mutate(community = as.factor(membership(w))) %>%
left_join(select(metadata, c(id, cohort)))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight,
# rescale width because massive range in values
width = rescale(weight)))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight)+
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
# plot ggraph
ggraph(comm)+
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
?cluster_walktrap
# community with walktrap
w <- cluster_walktrap(network, steps = 10)
length(w)
modularity(w)
membership(w)
# set seed to keep layout static
set.seed(0000)
networkfr <- create_layout(network, layout = "fr")
# add community and cohort to network layout
comm <- networkfr %>%
rename(id = name) %>%
mutate(community = as.factor(membership(w))) %>%
left_join(select(metadata, c(id, cohort)))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue3")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(-2, 4.5), y = c(-3, 3))
View(comm)
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7), y = c(-3, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7), y = c(-4, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(1, 8), y = c(-4, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7.5), y = c(-4, 3))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7.5), y = c(-4, 2.5))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7), y = c(-4, 2.5))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7), y = c(-3.8, 2.5))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1.1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7), y = c(-3.8, 2.6))
# plot ggraph
ggraph(comm)+
# format edge colour, alpha and width by the weight (proximity)
geom_edge_fan(aes(colour = weight, alpha = weight))+
scale_edge_color_continuous(low = "grey", high = "slateblue4")+
# node shape by cohort
geom_node_point(aes(shape = cohort), size = 5)+
scale_shape_manual(values=c(15, 16))+
# add communites
geom_mark_hull(aes(x = x, y = y, fill = community),
colour = "white", alpha = 0.2, expand = unit(1, "cm"))+
scale_fill_manual(values = c("plum", "skyblue2"))+
# add labels
#geom_node_text(aes(label = id), nudge_y = 0.17)+
# theme
theme_void()+
theme(legend.position="none")+
expand_limits(x = c(2, 7), y = c(-3.8, 2.6))
# plot daily roost distance over time as linear model
ggplot(datam2)+
geom_smooth(aes(date, distance_previous, color = social), method = "lm")+
theme_minimal() +
xlab("Date") +
ylab("Daily distance between roosts (m)")
# plot release site distance over time as linear model
ggplot(datam3)+
geom_smooth(aes(date, dist_release, color = social), method = "lm")+
theme_minimal() +
xlab("Date") +
ylab("Distance from release site (m)")
# plot daily roost distance over time as linear model
ggplot(datam2)+
geom_smooth(aes(date, distance_previous, color = social), method = "lm")+
theme_minimal() +
xlab("Date") +
ylab("Daily distance between roosts (m)")+
scale_colour_viridis_d()
# plot release site distance over time as linear model
ggplot(datam3)+
geom_smooth(aes(date, dist_release, color = social), method = "lm")+
theme_minimal() +
xlab("Date") +
ylab("Distance from release site (m)")+
scale_colour_viridis_d()
