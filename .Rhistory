na.action = "na.fail")
# model selection# moarea()del selection
dm9 <- dredge(m9)
dm9
# parsimonious model where delta <2 and fewest predictors
# in this case only one model (top ranked) had delta AICc <2
best9 <- get.models(dm9, delta<2)[[1]]
# check model
check_model(best9)
# summary
summary(best9)
# plot effects
plot_model(best9)
# Generate prediction data only within valid date ranges
release_date <- as_date("2023-06-07")
pred_data_pre <- expand.grid(
date = seq(min(datam9$date[datam9$period == "pre-reinforcement"]),
release_date - 1, by = 1),
period = "pre-reinforcement"
)
pred_data_post <- expand.grid(
date = seq(release_date, max(datam9$date[datam9$period == "post-reinforcement"]), by = 1),
period = "post-reinforcement"
)
# Combine and add necessary covariates (date2, id, etc.)
pred9 <- rbind(pred_data_pre, pred_data_post) %>%
mutate(id = NA)
# Predict values using the valid dataset
values9 <- predict(best9, newdata = pred9, type = "response", se.fit = TRUE) %>%
as.data.frame()
# Add predictions to dataframe - back transform the log values using exponential
pred9 <- pred9 %>%
mutate(
predicted = expm1(values9$fit),
lower = expm1(values9$fit - 1.96 * values9$se.fit),
upper = expm1(values9$fit + 1.96 * values9$se.fit)
) %>%
mutate(date = as_date(date))
# plot predictions
ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
ylab("Predicted values of home range size (ha)") +
theme_minimal()+
facet_wrap(~period, scales = "free_x")
# list of plots
g6 <- ggplot(pred6, aes(x, predicted, fill = group, ymin = conf.low, ymax = conf.high)) +
ylab("Daily distance moved (m)")+
theme()
g6
# list of plots
g6 <- ggplot(pred6, aes(x, predicted, ymin = conf.low, ymax = conf.high)) +
ylab("Daily distance moved (m)")+
theme()
g6
# list of plots
g6 <- ggplot(pred6, aes(x, predicted, group = period, ymin = conf.low, ymax = conf.high)) +
ylab("Daily distance moved (m)")+
theme()
g6
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
ylab("Predicted values of daily distance moved (m)") +
theme_minimal()+
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
ylab("Predicted values of daily distance moved (m)") +
theme_minimal()+
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
ylab("Predicted values of daily distance moved (m)") +
theme_minimal()+
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper))+
ylab("Daily distance moved (m)")+
theme()
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper))+
ylab("Daily distance moved (m)")+
theme()
g6
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
ylab("Predicted values of daily distance moved (m)") +
theme_minimal()
# plot predictions
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
ylab("Predicted values of daily distance moved (m)") +
theme_minimal()+
facet_wrap(~period, scales = "free_x")
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of daily distance moved (m)") +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
theme_minimal()+
facet_wrap(~period, scales = "free_x")
ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)") +
geom_line()+
geom_ribbon(alpha = 0.2)+
xlab(element_blank()) +
theme_minimal()+
facet_wrap(~period, scales = "free_x")
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x")
)
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of daily distance moved (m)")+
theme()
list(
geom_line(group = period),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x")
)
# set default theme options for all plots
theme <- function(){
list(
geom_line(group = period),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x")
)
}
# list of plots
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of daily distance moved (m)")+
theme()
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x")
)
}
# list of plots
ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of daily distance moved (m)")+
theme()
ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)")+
theme()
ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)")+
theme()
ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of home range size (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of home range size (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of roost fidelity (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Predicted values of home range size (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Roost displacement (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Distance from release (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Home range area (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x"),
scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Roost displacement (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Distance from release (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Home range area (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x"),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x"),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_minimal(),
facet_wrap(~period, scales = "free_x"),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Roost displacement (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Distance from release (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Home range area (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_bw(),
facet_wrap(~period, scales = "free_x"),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_bw(),
facet_wrap(~period, scales = "free_x",
labeller = labeller("Pre reinforcement", "Post reinforcement")),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_bw(),
facet_wrap(~period, scales = "free_x",
labeller = labeller("Pre reinforcement", "Post reinforcement")),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Roost displacement (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Distance from release (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Home range area (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
# set default theme options for all plots
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_bw(),
facet_wrap(~period, scales = "free_x",
labeller = labeller(period = c("Pre reinforcement", "Post reinforcement"))),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Roost displacement (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Distance from release (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Home range area (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
# set default theme options for all plots
labels <- c(`pre-reinforcement` = "Pre reinforcement",
`post-reinforcement` = "Post reinforcement")
labels
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_bw(),
facet_wrap(~period, scales = "free_x",
labeller = as_labeller(labels)),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
theme <- function(){
list(
geom_line(),
geom_ribbon(alpha = 0.2),
xlab(element_blank()),
theme_bw(),
facet_wrap(~period, scales = "free_x",
labeller = as_labeller(labels)),
scale_x_date(date_breaks = "1 month", date_labels =  "%b"),
ggplot2::theme(axis.title.y = element_text(hjust = 0.5, size = 10),
axis.title.x = element_text(size = 10))
)
}
# list of plots
g6 <- ggplot(pred6, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Daily distance moved (m)")+
theme()
g7 <- ggplot(pred7, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Roost displacement (m)")+
theme()
g8 <- ggplot(pred8, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Distance from release (m)")+
theme()
g9 <- ggplot(pred9, aes(date, predicted, ymin = lower, ymax = upper)) +
ylab("Home range area (ha)")+
theme()
# multi plot 3x2
combined_plot <- (g6 + g7)  / (g8 + g9) +
plot_annotation(tag_levels = 'A')
combined_plot
# save
ggsave("plots/resident_outcomes.png", dpi = 400, bg = 'white',
width = 15, height = 12, units = "cm")
# save
ggsave("plots/resident_outcomes.png", dpi = 400, bg = 'white',
width = 30, height = 24, units = "cm")
# save
ggsave("plots/resident_outcomes.png", dpi = 400, bg = 'white',
width = 20, height = 16, units = "cm")
# plot daily distance over time as period means
ggplot(sum6, aes(date, dist, ymin = lower, ymax = upper)) +
geom_path() +
geom_ribbon(alpha = 0.2) +
xlab("Days post-reinforcement") +
ylab("Daily distance moved (m)") +
theme_minimal() +
scale_fill_viridis_d()+
scale_colour_viridis_d()+
geom_vline(aes(xintercept = as_date("2023-06-07")), colour = "purple")
# plot daily distance over time as period means
ggplot(sum7, aes(date, dist, ymin = lower, ymax = upper)) +
geom_path() +
geom_ribbon(alpha = 0.2) +
xlab("Days post-reinforcement") +
ylab("Distance between consecutive roosts (m)") +
theme_minimal() +
scale_fill_viridis_d()+
scale_colour_viridis_d()+
geom_vline(aes(xintercept = as_date("2023-06-07")), colour = "purple")
# plot daily distance over time as period means
ggplot(sum8, aes(date, dist, ymin = lower, ymax = upper)) +
geom_path() +
geom_ribbon(alpha = 0.2) +
xlab("Days post-reinforcement") +
ylab("Distance from release site (m)") +
theme_minimal() +
scale_fill_viridis_d()+
scale_colour_viridis_d()+
geom_vline(aes(xintercept = as_date("2023-06-07")), colour = "purple")
# plot daily distance over time as period means
ggplot(sum9, aes(date, dist, ymin = lower, ymax = upper)) +
geom_path() +
geom_ribbon(alpha = 0.2) +
xlab("Days post-reinforcement") +
ylab("Home range (90% KUD) area (ha)") +
theme_minimal() +
scale_fill_viridis_d()+
scale_colour_viridis_d()+
geom_vline(aes(xintercept = as_date("2023-06-07")), colour = "purple")
